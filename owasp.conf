# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║  Lenoos Net Audit — owasp.conf                                         ║
# ║  Multi-Target OWASP API & Path Testing Configuration                   ║
# ╚═══════════════════════════════════════════════════════════════════════════╝
#
# This file defines API endpoints, paths, and test suites for OWASP
# security testing.  It is used by both native (-O) and AI-based (-M)
# pentest modules.
#
# Search order:
#   1. ./owasp.conf              (current directory)
#   2. <script_dir>/owasp.conf   (next to lenoos-net-audit.sh)
#   3. ~/.config/lenoos/owasp.conf
#
# ─── MULTI-TARGET SUPPORT ────────────────────────────────────────────────────
#
# When auditing multiple targets in a single report, each target can have
# its own configuration block.  Per-target blocks override global settings.
#
# Structure:
#
#   <global settings, paths, endpoints, suites>   ← defaults for all targets
#
#   [target:example.com]
#     ENABLED = true|false        ← enable/disable OWASP for this target
#     INHERIT_GLOBAL = true|false ← inherit global endpoints/suites (default: true)
#     <target-specific settings, paths, endpoints, suites>
#   [/target]
#
# A target inherits all global endpoints & suites by default (INHERIT_GLOBAL=true).
# Set INHERIT_GLOBAL=false to use only the target-specific entries.
# Set ENABLED=false to skip OWASP endpoint testing entirely for that target.
# Targets without a [target:] block still get global endpoints.
#
# ─── FORMAT ──────────────────────────────────────────────────────────────────
#
# SETTINGS (key = value):
#   SWAGGER_URL       Swagger / OpenAPI spec URL (auto-discovers endpoints)
#   BASE_URL          Base URL prefix for relative paths (optional)
#   AUTH_HEADER       Authorization header value, e.g. "Bearer <token>"
#   EXTRA_HEADERS     Additional headers, pipe-separated
#   TIMEOUT           Request timeout in seconds (default: 10)
#   VERIFY_SSL        true/false — verify TLS certificates (default: true)
#   ENABLED           true/false — enable/disable OWASP for this target (target only)
#   INHERIT_GLOBAL    true/false — inherit global entries (target only, default: true)
#
# PATHS (simple glob patterns):
#   /api/v1/*
#
# ENDPOINTS (pipe-delimited full specification):
#   METHOD|PATH|CONTENT_TYPE|BODY|EXPECT_STATUS|DESCRIPTION
#
# TEST SUITES:
#   [suite:SuiteName]
#     ... endpoint or path entries ...
#   [/suite]
#
# Lines starting with # are comments.  Blank lines are ignored.
# ─────────────────────────────────────────────────────────────────────────────

# ┌─────────────────────────────────────────────────────────────────────────┐
# │  GLOBAL SETTINGS  (defaults for ALL targets)                           │
# └─────────────────────────────────────────────────────────────────────────┘

# SWAGGER_URL = https://api.example.com/swagger.json
# BASE_URL    = https://api.example.com
# AUTH_HEADER = Bearer eyJhbGciOiJIUzI1NiIs...
# EXTRA_HEADERS = X-Custom: value1|X-Tenant: acme
# TIMEOUT     = 10
# VERIFY_SSL  = true

# ┌─────────────────────────────────────────────────────────────────────────┐
# │  GLOBAL PATHS & ENDPOINTS  (applied to all targets unless overridden)  │
# └─────────────────────────────────────────────────────────────────────────┘

# /health
# /status
# /.well-known/openid-configuration
# GET|/api/health|-|-|200|Global health check

# ┌─────────────────────────────────────────────────────────────────────────┐
# │  GLOBAL TEST SUITES                                                    │
# └─────────────────────────────────────────────────────────────────────────┘

# [suite:CommonSecurity]
# GET|/.env|-|-|403|Dotenv should be blocked
# GET|/wp-admin|-|-|403|WordPress admin should be blocked
# GET|/phpmyadmin|-|-|403|phpMyAdmin should be blocked
# GET|/.git/config|-|-|403|Git config should be blocked
# GET|/server-status|-|-|403|Apache status should be blocked
# [/suite]

# ╔═════════════════════════════════════════════════════════════════════════╗
# ║  PER-TARGET CONFIGURATIONS                                            ║
# ╠═════════════════════════════════════════════════════════════════════════╣
# ║                                                                       ║
# ║  Each [target:domain] block inherits global settings/endpoints by     ║
# ║  default. Override settings, add endpoints, or disable OWASP per      ║
# ║  target.                                                              ║
# ║                                                                       ║
# ╚═════════════════════════════════════════════════════════════════════════╝

# ── Website (marketing site — no API, just security checks) ──────────────
# [target:www.example.com]
#   ENABLED = true
#   INHERIT_GLOBAL = true
#   # Only global suites apply; no additional endpoints
# [/target]

# ── Web Application (frontend + auth) ────────────────────────────────────
# [target:app.example.com]
#   ENABLED = true
#   AUTH_HEADER = Bearer eyJhbGciOiJSUzI1NiIs...
#   TIMEOUT = 15
#
#   /dashboard
#   /settings
#   /profile
#
#   GET|/api/v1/me|-|-|200|Get current user profile
#   POST|/api/v1/auth/logout|-|-|200|Logout endpoint
#
#   [suite:AppAuth]
#   POST|/api/v1/auth/login|application/json|{"username":"admin","password":"admin"}|200|Login
#   POST|/api/v1/auth/register|application/json|{"username":"test","password":"test123"}|201|Register
#   GET|/api/v1/auth/me|-|-|401|Profile without token (should require auth)
#   POST|/api/v1/auth/refresh|-|-|401|Token refresh without token
#   [/suite]
# [/target]

# ── REST API (backend, full CRUD testing via Swagger) ────────────────────
# [target:api.example.com]
#   ENABLED = true
#   INHERIT_GLOBAL = false
#   SWAGGER_URL = https://api.example.com/openapi.json
#   BASE_URL = https://api.example.com
#   AUTH_HEADER = Bearer eyJhbGciOiJIUzI1NiIs...
#   EXTRA_HEADERS = X-Api-Version: 2|X-Tenant: production
#   TIMEOUT = 20
#   VERIFY_SSL = true
#
#   # Additional endpoints beyond Swagger
#   GET|/api/v2/users|-|-|200|List all users
#   GET|/api/v2/users/{id}|-|-|200|Get user by ID
#   POST|/api/v2/users|application/json|{"name":"test","email":"test@test.com"}|201|Create user
#   PUT|/api/v2/users/{id}|application/json|{"name":"updated"}|200|Update user
#   DELETE|/api/v2/users/{id}|-|-|204|Delete user
#
#   [suite:AdminEndpoints]
#   GET|/api/v2/admin/dashboard|-|-|401|Admin dashboard (auth required)
#   GET|/api/v2/admin/config|-|-|401|Server config (auth required)
#   GET|/api/v2/admin/users|-|-|401|User management (auth required)
#   DELETE|/api/v2/admin/cache|-|-|401|Cache purge (auth required)
#   [/suite]
#
#   [suite:UserCRUD]
#   GET|/api/v2/users|-|-|200|List users
#   POST|/api/v2/users|application/json|{"name":"t","email":"t@t.com"}|201|Create user
#   GET|/api/v2/users/{id}|-|-|200|Get single user
#   PUT|/api/v2/users/{id}|application/json|{"name":"updated"}|200|Update user
#   DELETE|/api/v2/users/{id}|-|-|204|Delete user
#   [/suite]
# [/target]

# ── Staging environment (disabled — skip OWASP for this target) ──────────
# [target:staging.example.com]
#   ENABLED = false
# [/target]
